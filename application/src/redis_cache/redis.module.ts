import { Module, forwardRef } from '@nestjs/common';
import { EventsGateway } from './socket_event.gateway';
import { RedisModule, RedisModuleOptions } from '@liaoliaots/nestjs-redis';
import { ConfigModule, ConfigService } from '@nestjs/config';
import { RedisCacheService } from './redis.service';
import { AdminModule } from 'src/admin/admin.module';
import { AdminService } from 'src/admin/admin.service';


@Module({
    imports: [
        forwardRef(() => AdminModule),
        RedisModule.forRootAsync({
            imports: [ConfigModule],
            inject: [ConfigService],
            useFactory: async (configService: ConfigService): Promise<RedisModuleOptions> => {
              
              return {
                config: [
                            {
                                namespace:'test1',
                                url: 'redis://localhost:6380',
                            },
                            {
                                namespace:'test2',
                                url: 'redis://localhost:6380',
                            },
                        ]
            }
          }})
    ],
    providers: [RedisCacheService,EventsGateway],
    exports: [RedisCacheService],
})
export class RedisCacheModule {}
