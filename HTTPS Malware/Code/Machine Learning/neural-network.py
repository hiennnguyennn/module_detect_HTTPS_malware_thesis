from sklearn.metrics import classification_report, confusion_matrix
from sklearn import metrics
import pandas as pd
from sklearn.neural_network import MLPClassifier

testSet=pd.read_csv('/home/hiennn/Documents/HTTPS malware/Detection HTTPS malware traffic - Strasak-Frantisek/Code/testSet.csv')
trainSet=pd.read_csv('/home/hiennn/Documents/HTTPS malware/Detection HTTPS malware traffic - Strasak-Frantisek/Code/trainSet.csv')
trainLabel=trainSet.iloc[:,-1]
trainData=trainSet.iloc[:,2:-1] 
testLabel=testSet.iloc[:,-1]
testData=testSet.iloc[:,2:-1]

clf = MLPClassifier(solver='adam', alpha=0.0001).fit(trainData, trainLabel)
y_pred=clf.predict(testData)
print(confusion_matrix(testLabel, y_pred))
print('-------------------------')
print("Accuracy:",metrics.accuracy_score(testLabel, y_pred))
print(classification_report(testLabel, y_pred))
print('-------------------------')
print('auc=',metrics.roc_auc_score(testLabel, y_pred))
