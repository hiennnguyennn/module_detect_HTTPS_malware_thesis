from sklearn.metrics import classification_report, confusion_matrix
from sklearn import metrics
import pandas as pd
from sklearn import svm
import numpy as np
from pathlib import Path
import os

def main(root_folder):
    # folder=Path(__file__).parents[1]
    # dataset=os.path.join(folder,'dataset_ver3')
    dataset=os.path.join(root_folder,'base_dataset')
    testSet=pd.read_csv('/home/hiennnn/Documents/DATN/HTTPS Malware/Code/dataset_update_normal_scenario2/testSet.csv')
    trainSet=pd.read_csv(os.path.join(dataset,'trainSet.csv'))
    trainLabel=trainSet.iloc[:,-1]
    trainData=trainSet.iloc[:,2:-1] 
    testLabel=testSet.iloc[:,-1]
    testData=testSet.iloc[:,2:-1]
    kernels= ['linear', 'poly', 'rbf', 'sigmoid']
    svm_C=110
    sv_gamma=0.1

    clf = svm.SVC(kernel=kernels[2], C=svm_C, gamma=sv_gamma)

    clf.fit(trainData, trainLabel)
    y_pred=clf.predict(testData)

    print(confusion_matrix(testLabel, y_pred))
    print('-------------------------')
    print("Accuracy:",metrics.accuracy_score(testLabel, y_pred))
    print("Precision score: ",metrics.precision_score(testLabel, y_pred))
    print("Recall score: ",metrics.recall_score(testLabel, y_pred))
    print("F1 score: ",metrics.f1_score(testLabel, y_pred))
    print(classification_report(testLabel, y_pred))
    print('-------------------------')
    # print('auc=',metrics.roc_auc_score(testLabel, y_pred))

main(Path(__file__).parents[1])