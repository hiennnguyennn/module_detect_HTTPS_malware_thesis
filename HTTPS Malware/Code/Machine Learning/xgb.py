import xgboost as xgb
from sklearn.metrics import classification_report, confusion_matrix
from sklearn import metrics
import pandas as pd
from pathlib import Path
import os

#from xgboost import XGBClassifier

def main(root_folder):
    dataset=os.path.join(root_folder,'base_dataset')
    testSet=pd.read_csv('/home/hiennnn/Documents/DATN/HTTPS Malware/Code/dataset_update_normal_scenario2/testSet.csv')
    trainSet=pd.read_csv(os.path.join(dataset,'trainSet.csv'))
    trainLabel=trainSet.iloc[:,-1]
    trainData=trainSet.iloc[:,2:-1] 
    testLabel=testSet.iloc[:,-1]
    testData=testSet.iloc[:,2:-1]
    # xgb_classifier = xgb.XGBClassifier(n_estimators=500, max_depth=10, gamma=0.1, min_child_weight=1)
    xgb_classifier = xgb.XGBClassifier(n_estimators=1000, max_depth=10, gamma=0, min_child_weight=1)
    # xgb_classifier = xgb.XGBClassifier(n_estimators=1000, max_depth=3, gamma=0.1, min_child_weight=5)
    xgb_classifier.fit(trainData,trainLabel)
    y_pred = xgb_classifier.predict(testData)

    print(confusion_matrix(testLabel, y_pred))
    print('-------------------------')
    print("Accuracy:",metrics.accuracy_score(testLabel, y_pred))
    print("Precision score: ",metrics.precision_score(testLabel, y_pred))
    print("Recall score: ",metrics.recall_score(testLabel, y_pred))
    print("F1 score: ",metrics.f1_score(testLabel, y_pred))
    print(classification_report(testLabel, y_pred))
    print('-------------------------')
    # xgb_classifier.save_model(os.path.join(root_folder,"Machine Learning/model_xgb1.bin"))
main(Path(__file__).parents[1])