from scapy.all import *
from scapy.utils import rdpcap
load_layer("tls")
ip_map = ["192.168.1.255"]
for pkt in rdpcap("/home/hiennnn/Downloads/2021-11-15_win4.pcap"):
    ip_src=None
    ip_dst=None
    if IP in pkt:
        ip_src=pkt[IP].src
        ip_dst=pkt[IP].dst
    if TCP in pkt:
        tcp_sport=pkt[TCP].sport
        tcp_dport=pkt[TCP].dport
    #sys.exit()
    if ip_src is not None and ip_src in ip_map:
        del(pkt.chksum)
        sendp(pkt)
        # sys.exit()
        # try:
        #     del(pkt.chksum)
        # except Exception as exception:
        #     print(22222,exception)
        #     # pkt[IP].src="192.168.5.107"
        #     # pkt[Ether].src= "e4:a4:71:b3:61:a4"
        # send(pkt)
